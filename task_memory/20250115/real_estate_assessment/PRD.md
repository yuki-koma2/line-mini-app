# PRD：不動産価値診断・目減りリスク可視化サービス（MVP）

## 1. プロダクト概要

### 目的
ユーザーが保有不動産の「資産価値の現状」と「将来の目減りリスク」を数値で把握し、次のアクション（売却・賃貸・リフォーム判断）を明確にできるサービスを提供する。

### 背景
不動産保有者は「いつ売るべきか」「このまま持つべきか」の判断を曖昧にしがちだが、特に価格目減りリスクを数値で定量化し視覚化することにより、行動の後押しを狙う。初期はLINEミニアプリで最小工数・最大効果を目指す。

## 2. スコープ（MVP範囲）

### ✅ 含める
- シンプルな価格診断（LIFFで完結）
- 「目減りリスク可視化」グラフ表示
- 「次の一手提案（例：査定依頼・シミュレーション）」
- Firestoreに記録
- LINE通知での定期リマインド

### ❌ 除外
- 仲介会社とのマッチング
- 個別物件管理・ローン計算・投資回収率計算
- 法人向け資産レポート機能

## 3. ユーザーストーリー

1. 自宅・投資用不動産オーナーとして、将来の価格目減りリスクを把握し、最も価値が下がる前に行動したい
2. 売却・賃貸・リフォームの判断の起点を簡単に見つけたい
3. 「いま何もしないことのコスト」を理解したい

## 4. 機能要件

### 4.1 フロントエンド

| 機能 | 内容 | 工夫ポイント |
|------|------|------------|
| 診断 | 物件種別・築年・立地・面積の選択式 | 入力負荷は最小限、6問以内 |
| 結果画面 | ・現在価値の推定<br>・3年/5年後価格下落予測グラフ<br>・周辺相場取引件数<br>・**数値カウントアップアニメーション** | グラフと「年間X万円目減り」と定量表示<br>**金額表示時はカウントアップアニメーション** |
| アクション提示 | 「あなたの場合、次の選択肢が有効です」1アクションのみ | 例：「今売却で＋150万円差益」「賃貸収入想定」 |

### 4.2 バックエンド

| 機能 | 内容 |
|------|------|
| DB | Firestore：LINE IDと診断結果のみ保存 |
| 通知 | LINE Push：相場下落通知・定期診断リマインド |

## 5. UI方針

- 「現状維持の損失」を感覚ではなく数値とグラフで提示
- 行動訴求は「あなたの選択肢→得られる利益 or 防げる損失」
- LINE内完結、ウェブサイト誘導は最小限
- **数値の視覚的インパクト強化**：金額表示時はカウントアップアニメーションで注目度を高める

## 6. 非機能要件

- LINEミニアプリ（LIFF）、Next.js（Vercel）、Firestore構成
- バックエンド不要、Firebase Functionsで完結
- MVP目標：LP＆LIFFリリースまで最長3週間
- **パフォーマンス**：カウントアップアニメーションは1-2秒で完了
- **アクセシビリティ**：アニメーションは必要に応じて無効化可能

## 7. 検証指標（KPI）

| 指標 | 目標 |
|------|------|
| 診断完了率 | 80%以上 |
| アクション起動率 | 60%以上 |
| LINE再訪率 | 30%以上（2週間以内） |

## 8. 診断ロジック詳細

### 8.1 前提
- 診断はシンプルなルールベース（if-else、score足し算）
- 目減りリスクは「築年数」「立地（駅距離）」「物件種別」「周辺取引件数」で算出

### 8.2 診断フロー

| 質問 | 選択肢 | スコア・ロジック例 |
|------|--------|------------------|
| 物件種別 | マンション/戸建て/土地 | 築年数×下落係数が物件種別で変化 |
| 築年数 | 0-5年/6-10年/11-20年/21年以上 | 年数ごとの平均下落率適用 |
| 駅徒歩距離 | 5分以内/6-15分/16分以上 | 駅距離ごとに減点 |
| 面積 | 50㎡以下/51-80㎡/80㎡以上 | 小規模物件は下落率高めに補正 |
| 周辺成約件数 | 月10件以上/5-10件/5件未満 | 流動性スコア適用 |

### 8.3 結果の出し方

例）
- 現在価格：周辺相場㎡単価×面積（仮定）
- 3年後：現在価格 - (現在価格×下落スコア)
- 5年後：同様に算出
- 目減り額例：3年後▲150万円（▲10%）
- 次の行動：今売れば＋150万円、3年放置なら▲150万円

**表示仕様**：
- 全ての金額（現在価格、3年後価格、5年後価格、目減り額）は0からカウントアップ
- アニメーション時間：1-2秒
- イージング：ease-out（最初速く、徐々に減速）

## 9. LINE Messaging API設定

### 9.1 前提
- LINE公式アカウント：フリープラン or 月額プラン
- Messaging API設定 → Webhook先：Firebase Functions

### 9.2 基本構成
1. LIFF起動 → 診断結果送信
2. 診断完了時：push でサンクスメッセージ＋次アクション
3. 1週間後：定期Pushで「最近のエリア取引情報」送付

### 9.3 Webhookレスポンス例

```json
{
  "to": "<LINE_USER_ID>",
  "messages": [
    {
      "type": "text",
      "text": "診断完了🎉\n現在の資産価値：2,800万円\n3年後予測：2,500万円（▲300万円）\n→ 今なら高く売れるチャンス！\n👇詳しくはこちら",
      "quickReply": {
        "items": [
          {
            "type": "action",
            "action": {
              "type": "uri",
              "label": "無料売却シミュレーション",
              "uri": "https://your-liff-app-url/"
            }
          }
        ]
      }
    }
  ]
}
```

### 9.4 Push通知例（Firebase Functions）

```typescript
import { messaging } from '@line/bot-sdk';
const client = new messaging.Client({ channelAccessToken: process.env.LINE_TOKEN });
await client.pushMessage(lineUserId, {
  type: 'text',
  text: `最近の周辺相場：平均▲1.5%下落傾向📉\n再診断してみますか？`,
});
```